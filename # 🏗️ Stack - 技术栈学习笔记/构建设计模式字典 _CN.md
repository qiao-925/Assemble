# ğŸš€ **è®¾è®¡æ¨¡å¼å­—å…¸ - ä¸­æ–‡ç‰ˆ**

https://draveness.me/holy-grail-design-pattern/

https://www.cnblogs.com/wxdlut/p/17346906.html

https://developer.aliyun.com/article/342530

https://www.infoq.cn/article/design-patterns-proposed-by-gof-20-years-ago

## ğŸ’­ **å…³äºè®¾è®¡æ¨¡å¼çš„äº‰è®®**

è¿‘å¹´æ¥ï¼Œå…³äºè®¾è®¡æ¨¡å¼çš„äº‰è®ºéå¸¸æ¿€çƒˆã€‚

**ç†è§£å’Œå­¦ä¹ å®ƒæ˜¯ç¬¬ä¸€æ­¥ï¼ˆå¦‚æœä½ æƒ³è°ˆè®ºå®ƒï¼Œæ— è®ºä½ ç«™åœ¨å“ªä¸€è¾¹ï¼‰ã€‚**

ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šæ— ç–‘æ˜¯ä¸€ä¸ªæ˜æ™ºçš„é€‰æ‹©ã€‚ä½œä¸ºç»éªŒçš„æ±‡é›†ï¼Œæ— ç–‘è§è¯äº†å‰è¾ˆä»¬æ˜¯å¦‚ä½•è¿ç”¨é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰æ€æƒ³çš„ã€‚è¿™23ç¯‡ç»éªŒæ±‡é›†å±•ç°äº†ä¸€æ®µè¾‰ç…Œçš„å†å²ã€‚

**å¦‚ä½•åº”ç”¨å®ƒæ˜¯ç¬¬äºŒæ­¥ï¼Œè€Œåˆ†æ­§ä¹Ÿç”±æ­¤è€Œæ¥ã€‚**
æœ‰äº›äººå°†è®¾è®¡æ¨¡å¼å¥‰ä¸ºå¤©å ‚ï¼Œè®¤ä¸ºå®ƒä»¬æ˜¯æœ€ä½³å®è·µï¼Œå¹¶è¢«å¹¿æ³›ä½¿ç”¨ã€‚
å¦ä¸€äº›äººåˆ™å°†è®¾è®¡æ¨¡å¼è´¬ä½ä¸ºåœ°ç‹±ï¼Œè®¤ä¸ºå®ƒä»¬ä¸è¿‡æ˜¯è¿‡å»çš„ç³Ÿç²•ï¼Œå¹¶ä¸é€‚ç”¨äºå½“ä¸‹ã€‚
å½“ç„¶ï¼Œå¤§å¤šæ•°äººæŒä¸­ç«‹æ€åº¦ã€‚

**å°½ä¿¡ä¹¦ä¸å¦‚æ— ä¹¦ã€‚è¿½æ±‚ä½è€¦åˆï¼Œä½†ä¸å¯èƒ½å®Œå…¨æ²¡æœ‰è€¦åˆã€‚**

é¦–å…ˆï¼Œåœ¨å®é™…åº”ç”¨ä¸­è€ƒè™‘ä½¿ç”¨è®¾è®¡æ¨¡å¼å¹¶æ²¡æœ‰é”™ã€‚è¿™åªæ˜¯åˆ©ç”¨ç°æœ‰çš„è§£å†³æ–¹æ¡ˆæ¥è§£å†³ç°æœ‰çš„é—®é¢˜ã€‚

ç„¶è€Œï¼Œåœ¨åˆ†æå’Œå¤„ç†é—®é¢˜æ—¶ï¼Œå¹¶ä¸åº”è¯¥å±€é™äºè®¾è®¡æ¨¡å¼ã€‚è®¾è®¡æ¨¡å¼æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹ï¼ˆOOPï¼‰æ€ç»´çš„æœ€ä½³å®è·µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼ŒOOP çš„è½åœ°ç»éªŒäº§ç”Ÿäº†è®¾è®¡æ¨¡å¼ã€‚

é¢å¯¹å®é™…é—®é¢˜æ—¶ï¼ŒOOP æ€ç»´åº”è¯¥æ˜¯ç¬¬ä¸€ååº”ã€‚åœ¨ OOP æ€ç»´ä¸‹ï¼Œé—®é¢˜æ‰æœ‰ä¸€ä¸ªå¯¹åº”çš„ä¸Šä¸‹æ–‡ã€‚è¿™äº›ä¸Šä¸‹æ–‡å°±æ˜¯è®¾è®¡æ¨¡å¼çš„æºæ³‰ã€‚åŒæ—¶ï¼Œå¯ä»¥è€ƒè™‘å½“å‰é—®é¢˜æ˜¯å¦ä¸è®¾è®¡æ¨¡å¼ä¸­å·²ç»è§£å†³çš„é—®é¢˜ç›¸åŒ¹é…ã€‚

**OOPå’Œè®¾è®¡æ¨¡å¼çš„æ¯”å–»ï¼šä¹˜æ³•è§„åˆ™ / 25*25 = 625**

æ¥ä¸‹æ¥ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ­¥ â€”â€” **å¹³è¡¡ ä¸å–èˆ** ã€‚
è¿™æ˜¯æŠŠæ¡è®¾è®¡ä¸è¿‡åº¦è®¾è®¡çš„å…³é”®ä¸€æ­¥ï¼Œå…³é”®åœ¨äº**åˆ©å¤§äºå¼Š**ã€‚

è®¾è®¡æ¨¡å¼å¹¶ä¸èƒ½è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œåè€Œä¼šå¸¦æ¥æ–°çš„é—®é¢˜ã€‚ä½†å¦‚æœè§£å†³é—®é¢˜çš„ä»·å€¼å¤§äºæ–°é—®é¢˜çš„å¼Šç«¯ï¼Œé‚£å°±ä½¿ç”¨å®ƒã€‚

è¿™æ¡è§„åˆ™ä¼¼ä¹ä¸ä»…é™äºè®¾è®¡æ¨¡å¼ï¼Œæ‰€æœ‰æ–¹æ³•è®ºéƒ½é€‚ç”¨ã€‚**åŠ¨æ€åœ°åˆ†æé—®é¢˜å¤„ç†æ–¹å¼çš„ä¼˜åŠ£ï¼Œæ˜¯ä¸ºäº†è¾¾åˆ°ä¸€ä¸ªå‡†ç¡®åˆç†çš„ç»ˆç‚¹ã€‚**

## ğŸ—ï¸ **åˆ›å»ºå¯¹è±¡çš„æ¨¡å¼**

## ğŸ”’ **å•ä¾‹æ¨¡å¼**

å…¨å±€å”¯ä¸€ï¼›é€šè¿‡æ·»åŠ ç±»ä¼¼ @Component çš„æ³¨è§£ï¼ŒSpring bean çš„ä½œç”¨åŸŸä¸ºå•ä¾‹ã€‚

## ğŸ§¬ **åŸå‹æ¨¡å¼**

é€šè¿‡å¤åˆ¶æ—§å¯¹è±¡åˆ›å»ºå¯¹è±¡ï¼›ä¸º Spring bean è®¾ç½® @Scope("prototype")ã€‚

## ğŸ—ï¸ **å»ºé€ è€…æ¨¡å¼**

ä½¿ç”¨å»ºé€ è€…æ¨¡å¼åˆ›å»ºå¤æ‚å¯¹è±¡ï¼Œæ— éœ€åœ¨æ„é€ å‡½æ•°ä¸­ä¼ é€’å¤§é‡å‚æ•°ï¼›ä¸ºå¯¹è±¡æ·»åŠ  Lombok çš„ @Builder æ³¨è§£ã€‚

## ğŸ­ **å·¥å‚æ¨¡å¼**

å°è£…ä¸€ç»„æˆ–å¤šç»„å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼Œå¹¶æä¾›ç»Ÿä¸€çš„å‚æ•°åŒ–å¯¹è±¡åˆ›å»ºå…¥å£ã€‚[ç»“åˆç­–ç•¥æ¨¡å¼å®ç°]

- å·¥å‚æ–¹æ³•
- æŠ½è±¡å·¥å‚ â€”â€” å·¥å‚çš„å·¥å‚

## ğŸ­ **å¯¹è±¡è¡Œä¸ºæ¨¡å¼**

## ğŸ¯ **ç­–ç•¥æ¨¡å¼**

**èƒŒæ™¯**ï¼šå¯¹äºå¯¹è±¡çš„å•ä¸€è¡Œä¸ºï¼Œåœ¨ä¸åŒåœºæ™¯ä¸‹ä¼šæœ‰ä¸åŒçš„å®ç°ã€‚

**æ€è·¯**ï¼šæ·»åŠ ç­–ç•¥å±‚ï¼ˆç­–ç•¥æ¥å£ï¼‰ï¼Œè§£è€¦ç¨‹åºè°ƒç”¨ä¸å®ç°ï¼Œå®ç°ç¨‹åºçš„å¯æ‰©å±•æ€§ã€‚

**Implemention**: https://github.com/qiao-925/Strategy-pattern-demo

## ğŸ“‹ **æ¨¡æ¿æ¨¡å¼**

**èƒŒæ™¯ï¼š**å¯¹äºä¸€ç»„æ“ä½œï¼Œå¤§å¤šæ•°æ­¥éª¤ç›¸åŒï¼Œåªæœ‰å°‘æ•°æ­¥éª¤ä¸åŒï¼Œè¿™å°†äº§ç”Ÿå¤§é‡é‡å¤ä»£ç ã€‚

**æ€è·¯**ï¼šå®šä¹‰ç¨‹åºçš„æ¡†æ¶ï¼Œå¹¶å°†éƒ¨åˆ†æ­¥éª¤æ¨è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä»¥å®ç°æ¨¡æ¿ä»£ç å¤ç”¨ã€‚

## ğŸ‘ï¸ **è§‚å¯Ÿè€…æ¨¡å¼**

å¯¹è±¡çº§åˆ«çš„ MQã€‚

ä¸“æ³¨äºå¯¹è±¡çº§åˆ«çš„äº‹ä»¶å‘å¸ƒå’Œæ¶ˆæ¯é€šçŸ¥

## ğŸ”— **èŒè´£é“¾æ¨¡å¼**

æ ¹æ®å•ä¸€èŒè´£åŸåˆ™ï¼Œå°†å¤æ‚çš„ä¸šåŠ¡å¤„ç†æµç¨‹æ‹†åˆ†æˆé“¾è¡¨ç»“æ„ï¼Œä»¥å®ç°å¯è¯»æ€§å’Œå¯æ‰©å±•æ€§ã€‚

## âš¡ **å‘½ä»¤æ¨¡å¼**

è§£è€¦è¯·æ±‚å‘é€è€…å’Œæ¥æ”¶è€…ã€‚

- code example
    
    ```jsx
    // å‘½ä»¤æ¥å£
    public interface Command {
        void execute();
    }
    
    // æ¥æ”¶è€…
    public class Light {
        public void turnOn() {
            System.out.println("The light is on.");
        }
    
        public void turnOff() {
            System.out.println("The light is off.");
        }
    }
    
    // å…·ä½“å‘½ä»¤ï¼šæ‰“å¼€ç¯
    public class TurnOnLightCommand implements Command {
        private Light light;
    
        public TurnOnLightCommand(Light light) {
            this.light = light;
        }
    
        @Override
        public void execute() {
            light.turnOn();
        }
    }
    
    // å…·ä½“å‘½ä»¤ï¼šå…³é—­ç¯
    public class TurnOffLightCommand implements Command {
        private Light light;
    
        public TurnOffLightCommand(Light light) {
            this.light = light;
        }
    
        @Override
        public void execute() {
            light.turnOff();
        }
    }
    
    // è°ƒç”¨è€…
    public class RemoteControl {
        private Command command;
    
        public void setCommand(Command command) {
            this.command = command;
        }
    
        public void pressButton() {
            command.execute(); // æ‰§è¡Œå‘½ä»¤
        }
    }
    
    public class Client {
        public static void main(String[] args) {
            Light light = new Light(); // åˆ›å»ºæ¥æ”¶è€…
            Command turnOn = new TurnOnLightCommand(light); // åˆ›å»ºæ‰“å¼€ç¯çš„å‘½ä»¤
            Command turnOff = new TurnOffLightCommand(light); // åˆ›å»ºå…³é—­ç¯çš„å‘½ä»¤
    
            RemoteControl remote = new RemoteControl(); // åˆ›å»ºè°ƒç”¨è€…
    
            // æ‰“å¼€ç¯
            remote.setCommand(turnOn);
            remote.pressButton();
    
            // å…³é—­ç¯
            remote.setCommand(turnOff);
            remote.pressButton();
        }
    }
    ```
    

## å¤‡å¿˜å½•æ¨¡å¼

ç›®æ ‡ï¼šç”¨äºå¯¹è±¡çš„å†å²è®°å½•å’Œå¤‡ä»½ã€‚

ç¤ºä¾‹ï¼šç”¨äºç¼–è¾‘å™¨ï¼Œè®°å½•å’Œæ¢å¤å†å²çŠ¶æ€ã€‚

- code example
    
    ```jsx
    public class Originator {
        private String state;
    
        public Originator(String state) {
            this.state = state;
        }
    
        public String getState() {
            return state;
        }
    
        public void setState(String state) {
            this.state = state;
        }
    /**
    * right here
    **/
        **public Memento createMemento() {
            return new Memento(state);
        }
    
        public void restoreMemento(Memento memento) {
            this.state = memento.getState();
        }**
    
        // Inner class for Memento
        public static class Memento {
            private final String state;
    
            public Memento(String state) {
                this.state = state;
            }
    
            public String getState() {
                return state;
            }
        }
    }
    ```
    

---

å…³äºæ­¤æ¨¡å¼ï¼Œè®¨è®ºçš„æ˜¯ï¼š

å¦‚ä½•åœ¨ä¸ç ´åå°è£…æ€§çš„æƒ…å†µä¸‹å…¬å¼€ç§æœ‰æˆå‘˜å˜é‡æ•°æ®ï¼Ÿ

å½“ç„¶ï¼Œä»ç§æœ‰å˜ä¸ºå…¬å…±å¾ˆå®¹æ˜“ï¼Œä½†è¿™ä¼šç ´åå°è£…æ€§ã€‚

**è§£å†³æ–¹æ¡ˆï¼šå¯¹è±¡æœ¬èº«ä¿ç•™åˆ›å»ºå¤‡ä»½çš„åŠŸèƒ½ã€‚**

é¡ºä¾¿è¯´ä¸€å¥ï¼Œè¿™ä¸å……è¡€æ¨¡å‹çš„æ€ç»´ç›¸å…³ã€‚

[å¤‡å¿˜å½•æ¨¡å¼å’Œå……è¡€æ¨¡å‹æ¯”è¾ƒ â€”â€” from manus](https://www.notion.so/from-manus-2536c2e8d0dd80099b22c57b95b968fa?pvs=21)

https://refactoringguru.cn/design-patterns/memento

## **çŠ¶æ€æ¨¡å¼**

ä¸ºæ¯ä¸ªçŠ¶æ€åŠå…¶è¡Œä¸ºåˆ›å»ºç±»ï¼Œä»¥å‡å°‘è¶…è¿‡ 3 ä¸ªâ€œif/elseâ€è¯­å¥çš„å¤æ‚æ€§ã€‚

æ›´æ˜“è¯»ã€æ›´æ˜“äºç»´æŠ¤ï¼Œä½†ç±»å¤ªå¤šã€‚

- comparation
    
    normal implemention:
    
    ```jsx
    public class ContentWithoutState {
        private String status = "è‰ç¨¿"; // åˆå§‹çŠ¶æ€ä¸ºè‰ç¨¿
    
        public void publish() {
            if (status.equals("è‰ç¨¿")) {
                status = "å¾…å‘å¸ƒ";
                System.out.println("å†…å®¹å·²æäº¤å¾…å‘å¸ƒ");
            } else if (status.equals("å¾…å‘å¸ƒ")) {
                // æ¨¡æ‹Ÿå‘å¸ƒè¿‡ç¨‹ï¼Œå¯èƒ½æˆåŠŸæˆ–å¤±è´¥
                boolean success = Math.random() < 0.8; // 80%æ¦‚ç‡æˆåŠŸ
                if (success) {
                    status = "å·²å‘å¸ƒ";
                    System.out.println("å†…å®¹å‘å¸ƒæˆåŠŸ");
                } else {
                    status = "å‘å¸ƒå¤±è´¥";
                    System.out.println("å†…å®¹å‘å¸ƒå¤±è´¥");
                }
            } else {
                System.out.println("å†…å®¹çŠ¶æ€ä¸å…è®¸å‘å¸ƒ");
            }
        }
    
        public String getStatus() {
            return status;
        }
    
        public static void main(String[] args) {
            ContentWithoutState content = new ContentWithoutState();
            content.publish();
            System.out.println("å½“å‰çŠ¶æ€: " + content.getStatus());
            content.publish();
            System.out.println("å½“å‰çŠ¶æ€: " + content.getStatus());
            content.publish();
            System.out.println("å½“å‰çŠ¶æ€: " + content.getStatus());
        }
    }
    ```
    
    implementiom by state pattern
    
    ```jsx
    interface ContentStatus {
        void publish(Content content);
    }
    
    class DraftStatus implements ContentStatus {
        @Override
        public void publish(Content content) {
            System.out.println("å†…å®¹å·²æäº¤å¾…å‘å¸ƒ");
            content.setStatus(content.getPendingStatus());
        }
    }
    
    class PendingStatus implements ContentStatus {
        @Override
        public void publish(Content content) {
            boolean success = Math.random() < 0.8; // 80%æ¦‚ç‡æˆåŠŸ
            if (success) {
                System.out.println("å†…å®¹å‘å¸ƒæˆåŠŸ");
                content.setStatus(content.getPublishedStatus());
            } else {
                System.out.println("å†…å®¹å‘å¸ƒå¤±è´¥");
                content.setStatus(content.getFailedStatus());
            }
        }
    }
    
    class PublishedStatus implements ContentStatus {
        @Override
        public void publish(Content content) {
            System.out.println("å†…å®¹å·²å‘å¸ƒï¼Œæ— æ³•å†æ¬¡å‘å¸ƒ");
        }
    }
    
    class FailedStatus implements ContentStatus {
        @Override
        public void publish(Content content) {
            System.out.println("å†…å®¹å‘å¸ƒå¤±è´¥ï¼Œè¯·æ£€æŸ¥é”™è¯¯å¹¶é‡æ–°æäº¤");
        }
    }
    
    public class ContentWithState {
        private ContentStatus status;
        private DraftStatus draftStatus = new DraftStatus();
        private PendingStatus pendingStatus = new PendingStatus();
        private PublishedStatus publishedStatus = new PublishedStatus();
        private FailedStatus failedStatus = new FailedStatus();
    
        public ContentWithState() {
            this.status = draftStatus;
        }
    
        public void publish() {
            status.publish(this);
        }
    
        public void setStatus(ContentStatus status) {
            this.status = status;
        }
    
        public ContentStatus getDraftStatus() { return draftStatus; }
        public ContentStatus getPendingStatus() { return pendingStatus; }
        public ContentStatus getPublishedStatus() { return publishedStatus; }
        public ContentStatus getFailedStatus() { return failedStatus; }
    
        public static void main(String[] args) {
            ContentWithState content = new ContentWithState();
            content.publish();
            content.publish();
            content.publish();
        }
    }
    ```
    

## è®¿é—®è€…æ¨¡å¼

å°†æ•°æ®ç»“æ„ä¸ä½œç”¨äºå®ƒä»¬çš„ç®—æ³•åˆ†ç¦»ã€‚

- Example by json operations:
    
    ```jsx
    import org.json.JSONObject;
    
    interface JsonVisitor {
        void visit(JSONObject jsonObject);
    }
    
    class PrintJsonVisitor implements JsonVisitor {
        @Override
        public void visit(JSONObject jsonObject) {
            System.out.println("Name: " + jsonObject.getString("name"));
            System.out.println("Age: " + jsonObject.getInt("age"));
            System.out.println("City: " + jsonObject.getString("city"));
        }
    }
    
    class AgeSquareJsonVisitor implements JsonVisitor {
        @Override
        public void visit(JSONObject jsonObject) {
            int age = jsonObject.getInt("age");
            System.out.println("Age squared: " + age * age);
        }
    }
    
    class AgePlusTenJsonVisitor implements JsonVisitor {
        @Override
        public void visit(JSONObject jsonObject) {
            int age = jsonObject.getInt("age");
            System.out.println("Age plus 10: " + (age + 10));
        }
    }
    
    public class JsonWithVisitor {
        public static void main(String[] args) {
            String jsonString = "{\"name\":\"Alice\",\"age\":30,\"city\":\"New York\"}";
            JSONObject jsonObject = new JSONObject(jsonString);
    
            JsonVisitor printVisitor = new PrintJsonVisitor();
            printVisitor.visit(jsonObject);
    
            JsonVisitor ageSquareVisitor = new AgeSquareJsonVisitor();
            ageSquareVisitor.visit(jsonObject);
    
            JsonVisitor agePlusTenVisitor = new AgePlusTenJsonVisitor();
            agePlusTenVisitor.visit(jsonObject);
        }
    }
    ```
    

## ä¸­ä»‹è€…æ¨¡å¼

èƒŒæ™¯ï¼šå¤šä¸ªå¯¹è±¡ä¹‹é—´å­˜åœ¨å¤§é‡çš„ç›¸äº’ä¾èµ–å…³ç³»ã€‚

å…¶ç†å¿µä¸ IOC éå¸¸ç›¸ä¼¼ï¼šå°†å¯¹è±¡ä¹‹é—´çš„å¯¹è¯è½¬æ¢ä¸ºä¸­ä»‹è€…ä¸å¯¹è±¡ä¹‹é—´çš„å¯¹è¯ã€‚

# å¯¹è±¡ç»“æ„æ¨¡å¼

## **é€‚é…å™¨æ¨¡å¼**

æ·»åŠ é€‚é…å±‚æ¥è§£å†³æ¥å£ä¸å…¼å®¹é—®é¢˜ã€‚

ä¸“æ³¨äºæ¥å£å±‚é¢ã€‚

## æ¡¥æ¥æ¨¡å¼

å»¶è¿Ÿå®ä¾‹åŒ–å’Œç»‘å®šã€‚

ä½¿ç”¨ç»„åˆæ¨¡å¼ä»£æ›¿ç»§æ‰¿æ¨¡å¼ï¼Œä»¥é¿å…ç±»çš„æ’åˆ—ç»„åˆå¯¼è‡´çš„æ•°é‡æ¿€å¢ã€‚

- 
    
    ```jsx
    // Implementor interface
    interface MessageSender {
        void sendMessage(String message);
    }
    
    // Concrete Implementors
    class EmailSender implements MessageSender {
        @Override
        public void sendMessage(String message) {
            System.out.println("Sending email: " + message);
        }
    }
    
    class SmsSender implements MessageSender {
        @Override
        public void sendMessage(String message) {
            System.out.println("Sending SMS: " + message);
        }
    }
    
    // Abstraction
    abstract class Message {
        protected MessageSender sender;
    
        Message(MessageSender sender) {
            this.sender = sender;
        }
    
        abstract void send(String message);
    }
    
    // Refined Abstractions
    class UrgentMessage extends Message {
        UrgentMessage(MessageSender sender) {
            super(sender);
        }
    
        @Override
        void send(String message) {
            sender.sendMessage("URGENT: " + message);
        }
    }
    
    class NormalMessage extends Message {
        NormalMessage(MessageSender sender) {
            super(sender);
        }
    
        @Override
        void send(String message) {
            sender.sendMessage(message);
        }
    }
    
    // Client code
    public class BridgePatternDemo {
        public static void main(String[] args) {
            MessageSender emailSender = new EmailSender();
            MessageSender smsSender = new SmsSender();
    
            Message urgentEmail = new UrgentMessage(emailSender);
            urgentEmail.send("Meeting at 2 PM");
    
            Message normalSms = new NormalMessage(smsSender);
            normalSms.send("Reminder: Grocery shopping");
        }
    }
    ```
    

## ç»„åˆæ¨¡å¼

ä¸ºå®¢æˆ·ç«¯å±è”½å¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„å…·ä½“å®ç°æä¾›ç»Ÿä¸€çš„å¤„ç†æ¥å£ã€‚

- 
    
    ```jsx
    // æŠ½è±¡ç»„ä»¶
    public abstract class TreeNode {
        protected Long id;
        protected Long parentId;
        protected String name;
        protected Integer level;
        protected Integer sort;
        
        // å­èŠ‚ç‚¹æ“ä½œ
        public abstract void add(TreeNode node);
        public abstract void remove(TreeNode node);
        public abstract List<TreeNode> getChildren();
        
        // æ ‘å½¢ç»“æ„æ“ä½œ
        public abstract List<TreeNode> getPath();
        public abstract boolean isLeaf();
        public abstract int getDepth();
    }
    
    // å¶å­èŠ‚ç‚¹
    public class TreeLeaf extends TreeNode {
        @Override
        public void add(TreeNode node) {
            throw new UnsupportedOperationException("Leaf node cannot add child");
        }
        
        @Override
        public void remove(TreeNode node) {
            throw new UnsupportedOperationException("Leaf node cannot remove child");
        }
        
        @Override
        public List<TreeNode> getChildren() {
            return Collections.emptyList();
        }
        
        @Override
        public List<TreeNode> getPath() {
            return Collections.singletonList(this);
        }
        
        @Override
        public boolean isLeaf() {
            return true;
        }
        
        @Override
        public int getDepth() {
            return 0;
        }
    }
    
    // åˆ†æ”¯èŠ‚ç‚¹
    public class TreeBranch extends TreeNode {
        private List<TreeNode> children = new ArrayList<>();
        
        @Override
        public void add(TreeNode node) {
            children.add(node);
        }
        
        @Override
        public void remove(TreeNode node) {
            children.remove(node);
        }
        
        @Override
        public List<TreeNode> getChildren() {
            return Collections.unmodifiableList(children);
        }
        
        @Override
        public List<TreeNode> getPath() {
            List<TreeNode> path = new ArrayList<>();
            path.add(this);
            if (!children.isEmpty()) {
                path.addAll(children.get(0).getPath());
            }
            return path;
        }
        
        @Override
        public boolean isLeaf() {
            return children.isEmpty();
        }
        
        @Override
        public int getDepth() {
            if (children.isEmpty()) {
                return 0;
            }
            return 1 + children.stream()
                              .mapToInt(TreeNode::getDepth)
                              .max()
                              .orElse(0);
        }
    }
    ```
    

## **è£…é¥°å™¨æ¨¡å¼**

åŠ¨æ€åœ°ä¸ºå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚

- 
    
    ```jsx
    // ç»„ä»¶æ¥å£
    public interface Coffee {
        double cost();
        String getDescription();
    }
    
    // å…·ä½“ç»„ä»¶
    public class SimpleCoffee implements Coffee {
        @Override
        public double cost() {
            return 2.0; // åŸºç¡€å’–å•¡ä»·æ ¼
        }
    
        @Override
        public String getDescription() {
            return "Simple Coffee"; // æè¿°
        }
    }
    
    ----------------------------------------------------------------
    
    // è£…é¥°å™¨
    public abstract class CoffeeDecorator implements Coffee {
        protected Coffee coffee; // æŒæœ‰ä¸€ä¸ªCoffeeå¯¹è±¡
    
        public CoffeeDecorator(Coffee coffee) {
            this.coffee = coffee;
        }
    }
    
    // å…·ä½“è£…é¥°å™¨ï¼šç‰›å¥¶
    public class MilkDecorator extends CoffeeDecorator {
        public MilkDecorator(Coffee coffee) {
            super(coffee);
        }
    
        @Override
        public double cost() {
            return coffee.cost() + 0.5; // åŠ ç‰›å¥¶çš„é¢å¤–è´¹ç”¨
        }
    
        @Override
        public String getDescription() {
            return coffee.getDescription() + ", Milk"; // æ·»åŠ æè¿°
        }
    }
    
    // å…·ä½“è£…é¥°å™¨ï¼šç³–
    public class SugarDecorator extends CoffeeDecorator {
        public SugarDecorator(Coffee coffee) {
            super(coffee);
        }
    
        @Override
        public double cost() {
            return coffee.cost() + 0.2; // åŠ ç³–çš„é¢å¤–è´¹ç”¨
        }
    
        @Override
        public String getDescription() {
            return coffee.getDescription() + ", Sugar"; // æ·»åŠ æè¿°
        }
    }
    
    ---------------------------------------------------------------------------------------
    
    public class CoffeeShop {
        public static void main(String[] args) {
            Coffee coffee = new SimpleCoffee(); // åˆ›å»ºåŸºç¡€å’–å•¡
            System.out.println(coffee.getDescription() + " $" + coffee.cost());
    
            // æ·»åŠ ç‰›å¥¶è£…é¥°
            coffee = new MilkDecorator(coffee);
            System.out.println(coffee.getDescription() + " $" + coffee.cost());
    
            // æ·»åŠ ç³–è£…é¥°
            coffee = new SugarDecorator(coffee);
            System.out.println(coffee.getDescription() + " $" + coffee.cost());
        }
    }
    ```
    

## **å¤–è§‚æ¨¡å¼**

å°è£…å­ç³»ç»ŸåŠŸèƒ½å¹¶æä¾›ç®€å•çš„æ¥å£è°ƒç”¨ã€‚

- è®¡ç®—æœºå¯åŠ¨ç¤ºä¾‹
    
    ```jsx
    // å­ç³»ç»Ÿç±»1
    public class CPU {
        public void freeze() {
            System.out.println("CPU is freezing.");
        }
    
        public void jump(long position) {
            System.out.println("CPU is jumping to: " + position);
        }
    
        public void execute() {
            System.out.println("CPU is executing.");
        }
    }
    
    // å­ç³»ç»Ÿç±»2
    public class Memory {
        public void load(long position, byte[] data) {
            System.out.println("Memory is loading data at position: " + position);
        }
    }
    
    // å­ç³»ç»Ÿç±»3
    public class HardDrive {
        public byte[] read(long lba, int size) {
            System.out.println("HardDrive is reading data from LBA: " + lba + ", size: " + size);
            return new byte[size]; // è¿”å›æ¨¡æ‹Ÿæ•°æ®
        }
    }
    
    // å¤–è§‚ç±»
    public class ComputerFacade {
        private CPU cpu;
        private Memory memory;
        private HardDrive hardDrive;
    
        public ComputerFacade() {
            this.cpu = new CPU();
            this.memory = new Memory();
            this.hardDrive = new HardDrive();
        }
    
        public void startComputer() {
            cpu.freeze();
            memory.load(0, hardDrive.read(0, 1024));
            cpu.jump(0);
            cpu.execute();
        }
    }
    
    public class Client {
        public static void main(String[] args) {
            ComputerFacade computer = new ComputerFacade();
            computer.startComputer(); // å¯åŠ¨è®¡ç®—æœº
        }
    }
    ```
    

## äº«å…ƒæ¨¡å¼

**ä¹Ÿç§°ä¸ºï¼š**Â ç¼“å­˜

é€šè¿‡æ„å»ºæ˜ å°„å®ç°å¯¹è±¡é‡ç”¨ã€‚

- 
    
    ```jsx
    // äº«å…ƒæ¥å£
    public interface Shape {
        void draw(String color);
    }
    
    // å…·ä½“äº«å…ƒç±»
    public class Circle implements Shape {
        private String type; // å†…éƒ¨çŠ¶æ€
    
        public Circle() {
            this.type = "Circle"; // å…±äº«çš„çŠ¶æ€
        }
    
        @Override
        public void draw(String color) {
            System.out.println("Drawing a " + color + " " + type);
        }
    }
    
    // äº«å…ƒå·¥å‚
    import java.util.HashMap;
    import java.util.Map;
    
    public class ShapeFactory {
        private Map<String, Shape> shapes = new HashMap<>();
    
        public Shape getCircle(String color) {
            Shape circle = shapes.get(color);
            if (circle == null) {
                circle = new Circle();
                shapes.put(color, circle);
                System.out.println("Creating a new circle of color: " + color);
            }
            return circle;
        }
    }
    
    // å®¢æˆ·ç«¯ä»£ç 
    public class Client {
        public static void main(String[] args) {
            ShapeFactory shapeFactory = new ShapeFactory();
    
            // åˆ›å»ºå¹¶ä½¿ç”¨äº«å…ƒå¯¹è±¡
            Shape redCircle = shapeFactory.getCircle("Red");
            redCircle.draw("Red");
    
            Shape greenCircle = shapeFactory.getCircle("Green");
            greenCircle.draw("Green");
    
            // å…±äº«ç›¸åŒçš„å¯¹è±¡
            Shape anotherRedCircle = shapeFactory.getCircle("Red");
            anotherRedCircle.draw("Red");
    
            // è¾“å‡ºç»“æœ
            System.out.println("Red circle and another red circle are the same object: " + (redCircle == anotherRedCircle));
        }
    }
    ```
    

## ä»£ç†æ¨¡å¼

åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡æ¥æ§åˆ¶å¯¹çœŸå®å¯¹è±¡çš„è°ƒç”¨ï¼Œä»¥å®ç°é¢å¤–çš„åŠŸèƒ½ã€‚

- 
    
    ```jsx
    // ä¸»é¢˜æ¥å£
    public interface Subject {
        void request();
    }
    
    // çœŸå®å¯¹è±¡
    public class RealSubject implements Subject {
        @Override
        public void request() {
            System.out.println("RealSubject: Handling request.");
        }
    }
    
    // ä»£ç†å¯¹è±¡
    public class Proxy implements Subject {
        private RealSubject realSubject;
    
        @Override
        public void request() {
            if (realSubject == null) {
                realSubject = new RealSubject(); // å»¶è¿ŸåŠ è½½
            }
            // ä»£ç†çš„é¢å¤–åŠŸèƒ½
            System.out.println("Proxy: Pre-processing request.");
            realSubject.request(); // è°ƒç”¨çœŸå®å¯¹è±¡çš„æ–¹æ³•
            System.out.println("Proxy: Post-processing request.");
        }
    }
    
    // å®¢æˆ·ç«¯ä»£ç 
    public class Client {
        public static void main(String[] args) {
            Subject subject = new Proxy(); // ä½¿ç”¨ä»£ç†å¯¹è±¡
            subject.request(); // é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨è¯·æ±‚
        }
    }
    ```
    

**ä»£ç†æ¨¡å¼ä¸è£…é¥°å™¨æ¨¡å¼çš„åŒºåˆ«**ï¼šå®ç°æ–¹å¼ç±»ä¼¼ï¼Œä½†ç›®æ ‡ä¸åŒï¼š
ä»£ç†ï¼šä¸“æ³¨äºè°ƒç”¨å¯¹è±¡çš„æ§åˆ¶ã€‚
è£…é¥°å™¨ï¼šä¸“æ³¨äºåŠŸèƒ½æ‰©å±•ã€‚

```
action test 001
```